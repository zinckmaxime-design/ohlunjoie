<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ohlun'Joie V3.0</title>
  <link rel="stylesheet" href="style-v3-final.css">
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <div class="brand">
        <span class="logo-emoji">ğŸ¤</span>
        <span class="brand-name">Ohlun'Joie</span>
      </div>
      <div class="header-actions">
        <div class="view-switch">
          <button id="view-timeline" class="tab active">Timeline</button>
          <button id="view-list" class="tab">Liste</button>
          <button id="view-cards" class="tab">Cartes</button>
        </div>
        <button id="theme-toggle" class="icon-btn" aria-label="Changer de thÃ¨me">ğŸŒ™</button>
        <button id="admin-toggle" class="icon-btn" aria-label="Ouvrir lâ€™admin">â˜°</button>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="intro">
      <h1>Ã‰vÃ©nements</h1>
      <p id="intro-text">Notre association rassemble des bÃ©nÃ©voles passionnÃ©s qui organisent des Ã©vÃ©nements variÃ©s pour crÃ©er du lien social et enrichir la vie de notre commune.</p>
      <div class="next-event">
        <button id="next-event-btn" class="btn">Prochain Ã©vÃ©nement dans <span id="next-event-countdown">â€¦</span></button>
      </div>
    </section>

    <section id="public-section">
      <div id="timeline-view" class="view active"></div>
      <div id="list-view" class="view"></div>
      <div id="cards-view" class="view"></div>

      <details class="inscription-panel" id="inscription-panel">
        <summary>Inscription</summary>
        <form id="inscription-form">
          <div class="grid">
            <label>PrÃ©nom*<input name="prenom" required></label>
            <label>Nom*<input name="nom" required></label>
            <label>Email*<input name="email" type="email" required></label>
            <label>TÃ©lÃ©phone*<input name="telephone" required></label>
          </div>
          <label>Commentaire<textarea name="commentaire"></textarea></label>
          <fieldset class="participations">
            <legend>Participations (min 1)</legend>
            <label><input type="checkbox" name="preparation_salle"> PrÃ©paration salle</label>
            <label><input type="checkbox" name="partie_evenement"> Partie soirÃ©e</label>
            <label><input type="checkbox" name="evenement_entier"> SoirÃ©e entiÃ¨re</label>
          </fieldset>
          <label>Ã‰vÃ©nement
            <select id="inscription-event" name="event_id"></select>
          </label>
          <div class="rgpd-note">Vos donnÃ©es sont utilisÃ©es uniquement pour la gestion des inscriptions et ne seront jamais transmises Ã  des tiers.</div>
          <button type="submit" class="btn">Sâ€™inscrire</button>
        </form>
      </details>
    </section>

    <section id="admin-section">
      <h2>Administration</h2>
      <div class="login-row">
        <input id="admin-email" placeholder="Email admin">
        <input id="admin-password" type="password" placeholder="Mot de passe">
        <button id="admin-login" class="btn">Connexion</button>
      </div>
      <div class="tabs">
        <button data-tab="dash" class="tab active">Dashboard</button>
        <button data-tab="events" class="tab">Ã‰vÃ©nements</button>
        <button data-tab="stats" class="tab">Statistiques</button>
        <button data-tab="volunteers" class="tab">BÃ©nÃ©voles</button>
        <button data-tab="admins" class="tab">Gestion Admins</button>
        <button data-tab="config" class="tab">Configuration</button>
        <button data-tab="logs" class="tab">Logs</button>
      </div>

      <div class="tab-panels">
        <div id="tab-dash" class="tab-panel active">
          <div class="kpi-grid">
            <div class="kpi"><div class="kpi-label">Total Inscrits</div><div id="kpi-total" class="kpi-value">0</div></div>
            <div class="kpi"><div class="kpi-label">Ã‰vÃ©nements Actifs</div><div id="kpi-actifs" class="kpi-value">0</div></div>
            <div class="kpi"><div class="kpi-label">Emails Uniques</div><div id="kpi-emails" class="kpi-value">0</div></div>
            <div class="kpi"><div class="kpi-label">Taux Moyen</div><div id="kpi-taux" class="kpi-value">0%</div></div>
          </div>
        </div>

        <div id="tab-events" class="tab-panel">
          <div class="event-filters">
            <button class="chip active" data-filter="actifs">ğŸŸ¢ Actifs</button>
            <button class="chip" data-filter="masques">ğŸŸ  MasquÃ©s</button>
            <button class="chip" data-filter="archives">âš« ArchivÃ©s</button>
            <button class="chip" data-filter="tous">ğŸ“‹ Tous</button>
            <button id="event-new" class="btn">+ Nouvel Ã©vÃ©nement</button>
          </div>
          <div id="admin-events-cards" class="cards-grid"></div>
        </div>

        <div id="tab-stats" class="tab-panel">
          <div id="stats-kpis" class="kpi-grid"></div>
          <div id="stats-table" class="table-wrap"></div>
          <div class="actions-row">
            <button id="export-emails" class="btn">ğŸ“§ Export emails (txt)</button>
            <button id="export-stats" class="btn">ğŸ“¥ Export stats (CSV)</button>
          </div>
        </div>

        <div id="tab-volunteers" class="tab-panel">
          <div class="search-row">
            <input id="vol-search" placeholder="Rechercher bÃ©nÃ©vole (nom, prÃ©nom, email)">
          </div>
          <div id="vol-table" class="table-wrap"></div>
          <div class="actions-row">
            <button id="export-vol" class="btn">ğŸ“¥ Export bÃ©nÃ©voles (CSV)</button>
          </div>
        </div>

        <div id="tab-admins" class="tab-panel">
          <div class="actions-row">
            <button id="admin-add" class="btn">â• Ajouter admin</button>
          </div>
          <div id="admins-table" class="table-wrap"></div>
        </div>

        <div id="tab-config" class="tab-panel">
          <div class="config-grid">
            <div class="card">
              <h3>Logo</h3>
              <input id="logo-input" type="file" accept="image/*">
              <img id="logo-preview" alt="Logo" class="logo-preview" />
              <div class="actions-row">
                <button id="logo-save" class="btn">ğŸ’¾ Sauvegarder</button>
                <button id="logo-delete" class="btn danger">ğŸ—‘ï¸ Supprimer</button>
              </div>
            </div>
            <div class="card">
              <h3>Texte dâ€™intro</h3>
              <textarea id="intro-input" rows="5"></textarea>
              <button id="intro-save" class="btn">ğŸ’¾ Sauvegarder</button>
            </div>
            <div class="card">
              <h3>Types dâ€™Ã©vÃ©nements</h3>
              <div id="types-list" class="chips"></div>
              <div class="row">
                <input id="type-new" placeholder="Nouveau type">
                <button id="type-add" class="btn">â• Ajouter</button>
              </div>
            </div>
          </div>
        </div>

        <div id="tab-logs" class="tab-panel">
          <div id="logs-table" class="table-wrap"></div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      DÃ©veloppÃ© avec â¤ï¸ par Zinck Maxime â€” <a href="https://www.linkedin.com/in/zinck-maxime-88302b207" target="_blank" rel="noopener">LinkedIn</a>
    </div>
  </footer>

  <div id="toast" class="toast"></div>

  <script src="app-v3-final.js"></script>
</body>
</html>
