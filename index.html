<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ohlun'Joie - Association</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="flex items-center justify-between">
                <h1 class="header-title">🤝 Ohlun'Joie</h1>
                <button class="btn btn--outline" id="adminBtn">🔧 Administration</button>
            </div>
        </div>
    </header>

    <section class="logo-section">
        <div class="container text-center">
            <div class="association-logo" id="associationLogo">🤝</div>
        </div>
    </section>

    <section class="presentation-section">
        <div class="container">
            <div class="presentation-content">
                <div class="presentation-text">
                    <h2 class="presentation-title">Rejoignez notre communauté !</h2>
                    <p class="presentation-description" id="introText">
                        Notre association rassemble des bénévoles passionnés qui organisent des événements variés pour créer du lien social et enrichir la vie de notre commune.
                    </p>
                    <div class="presentation-cta">
                        <span class="cta-text">✨ Inscrivez-vous aux événements ci-dessous et rejoignez l'aventure !</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <main class="main-content" id="publicView">
        <div class="container">
            <div class="view-controls">
                <div class="view-buttons">
                    <button class="btn btn--primary active" data-view="timeline">📅 Timeline</button>
                    <button class="btn btn--outline" data-view="list">📋 Liste</button>
                    <button class="btn btn--outline" data-view="cards">🎴 Cartes</button>
                </div>
                <div class="next-event-info">
                    <div class="countdown-label">Prochain événement dans</div>
                    <div class="countdown-timer" id="countdownTimer">-</div>
                </div>
            </div>

            <div class="events-container timeline-view active" id="timelineView">
                <div class="timeline-rail"></div>
            </div>

            <div class="events-container list-view" id="listView">
                <div class="list-header">
                    <div>Date</div>
                    <div>Titre</div>
                    <div>Lieu</div>
                    <div>Participants</div>
                    <div>Action</div>
                </div>
                <div class="list-body"></div>
            </div>

            <div class="events-container cards-view" id="cardsView">
                <div class="cards-grid"></div>
            </div>
        </div>
    </main>

    <div class="admin-panel hidden" id="adminPanel">
        <div class="container">
            <div class="admin-header">
                <h2>🔧 Administration</h2>
                <button class="btn btn--secondary" id="logoutBtn">🚪 Déconnexion</button>
            </div>

            <div class="admin-nav">
                <button class="admin-nav-btn active" data-section="events" onclick="switchAdminSection('events')">📅 Événements</button>
                <button class="admin-nav-btn" data-section="stats" onclick="switchAdminSection('stats')">📊 Statistiques</button>
                <button class="admin-nav-btn" data-section="users" onclick="switchAdminSection('users')">👥 Utilisateurs</button>
                <button class="admin-nav-btn" data-section="config" onclick="switchAdminSection('config')">⚙️ Configuration</button>
            </div>

            <div class="admin-section active" id="eventsSection">
                <div class="section-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem">
                    <h3>📅 Gestion des Événements</h3>
                    <button class="btn btn--primary" onclick="openCreateEventModal()">➕ Créer un événement</button>
                </div>
                <div class="events-admin-table" id="eventsAdminList"></div>
            </div>

            <div class="admin-section" id="statsSection">
                <h3>📊 Statistiques & Analyses</h3>
                <div class="stats-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin:2rem 0">
                    <div class="stat-card" style="background:#fff;padding:1.5rem;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,0.1)">
                        <div style="display:flex;align-items:center;gap:1rem">
                            <div style="font-size:2rem">👥</div>
                            <div>
                                <div style="font-size:0.875rem;color:#6b7280">Total Inscrits</div>
                                <div style="font-size:1.5rem;font-weight:700;color:#2563EB" id="totalInscrits">0</div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card" style="background:#fff;padding:1.5rem;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,0.1)">
                        <div style="display:flex;align-items:center;gap:1rem">
                            <div style="font-size:2rem">📅</div>
                            <div>
                                <div style="font-size:0.875rem;color:#6b7280">Événements</div>
                                <div style="font-size:1.5rem;font-weight:700;color:#2563EB" id="totalEvents">0</div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card" style="background:#fff;padding:1.5rem;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,0.1)">
                        <div style="display:flex;align-items:center;gap:1rem">
                            <div style="font-size:2rem">📧</div>
                            <div>
                                <div style="font-size:0.875rem;color:#6b7280">Emails Uniques</div>
                                <div style="font-size:1.5rem;font-weight:700;color:#2563EB" id="totalEmails">0</div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card" style="background:#fff;padding:1.5rem;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,0.1)">
                        <div style="display:flex;align-items:center;gap:1rem">
                            <div style="font-size:2rem">📈</div>
                            <div>
                                <div style="font-size:0.875rem;color:#6b7280">Taux Moyen</div>
                                <div style="font-size:1.5rem;font-weight:700;color:#2563EB" id="avgRate">0%</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="background:#fff;padding:1.5rem;border-radius:8px;margin-top:2rem">
                    <h4 style="margin-bottom:1rem">📊 Détails par Événement</h4>
                    <div id="eventStatsList"></div>
                    <button class="btn btn--primary" onclick="exportEmails()" style="margin-top:1rem">📧 Exporter tous les emails</button>
                </div>
            </div>

            <div class="admin-section" id="usersSection">
                <div class="section-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem">
                    <h3>👥 Liste des Participants</h3>
                    <input type="text" id="userSearch" placeholder="🔍 Rechercher..." onkeyup="filterUsers()" style="padding:0.5rem 1rem;border:1px solid #d1d5db;border-radius:6px;width:300px">
                </div>
                <div class="users-list" id="usersList"></div>
                <button class="btn btn--primary" onclick="exportUsers()" style="margin-top:1rem">📥 Exporter la liste (CSV)</button>
            </div>

            <div class="admin-section" id="configSection">
                <h3>⚙️ Configuration</h3>
                <div class="config-forms">
                    <div class="config-group">
                        <h4>🖼️ Logo de l'association</h4>
                        <input type="file" id="logoUpload" accept="image/*">
                        <button class="btn btn--outline" id="removeLogo" style="margin-top:0.5rem">🗑️ Supprimer le logo</button>
                    </div>
                    <div class="config-group">
                        <h4>📝 Texte de présentation</h4>
                        <textarea id="introTextArea" rows="4"></textarea>
                        <button class="btn btn--primary" id="saveIntroText" style="margin-top:0.5rem">💾 Sauvegarder</button>
                    </div>
                    <div class="config-group">
                        <h4>🏷️ Types d'événements</h4>
                        <div id="eventTypesList"></div>
                        <div style="display:flex;gap:0.5rem;margin-top:0.5rem">
                            <input type="text" id="newEventType" placeholder="Nouveau type" style="flex:1">
                            <button class="btn btn--primary" id="addEventType">➕ Ajouter</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay hidden" id="loginModal">
        <div class="modal">
            <div class="modal-header">
                <h3>🔐 Connexion Administration</h3>
                <button class="modal-close">×</button>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="adminEmail">Email :</label>
                    <input type="email" id="adminEmail" value="zinck.maxime@gmail.com" required>
                </div>
                <div class="form-group">
                    <label for="adminPassword">Mot de passe :</label>
                    <input type="password" id="adminPassword" required>
                </div>
                <div class="error-message hidden" id="loginError">Email ou mot de passe incorrect !</div>
                <div class="form-actions">
                    <button type="button" class="btn btn--outline modal-close">Annuler</button>
                    <button type="submit" class="btn btn--primary">Se connecter</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal-overlay hidden" id="registrationModal">
        <div class="modal modal--large">
            <div class="modal-header">
                <h3>✅ Inscription à l'événement</h3>
                <button class="modal-close">×</button>
            </div>
            <form id="registrationForm">
                <div class="form-section">
                    <h4>Informations personnelles</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="regFirstName">Prénom *</label>
                            <input type="text" id="regFirstName" required>
                        </div>
                        <div class="form-group">
                            <label for="regLastName">Nom *</label>
                            <input type="text" id="regLastName" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="regEmail">Email *</label>
                            <input type="email" id="regEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="regPhone">Téléphone *</label>
                            <input type="tel" id="regPhone" required>
                        </div>
                    </div>
                </div>
                <div class="form-section">
                    <h4>Votre participation <span class="required">(minimum 1 obligatoire)</span></h4>
                    <div class="error-message hidden" id="participationError">⚠️ Veuillez sélectionner au moins une option</div>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="preparationSalle">
                            <span class="checkbox-text">Préparation salle jour J</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="partieEvenement">
                            <span class="checkbox-text">Une partie de la soirée</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="evenementEntier">
                            <span class="checkbox-text">La soirée entière</span>
                        </label>
                    </div>
                </div>
                <div class="form-section">
                    <div class="form-group">
                        <label for="regComment">Commentaires</label>
                        <textarea id="regComment" rows="3" placeholder="Précisions, contraintes horaires, questions..."></textarea>
                    </div>
                </div>
                <div class="form-section">
                    <div class="rgpd-notice">
                        <div class="rgpd-icon">🔒</div>
                        <div class="rgpd-text">
                            <strong>Protection des données personnelles</strong><br>
                            Les informations recueillies sont utilisées uniquement pour la gestion des inscriptions et ne sont jamais transmises à des tiers. Conformément à la loi « informatique et libertés », vous pouvez exercer votre droit d'accès aux données vous concernant.
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn--outline modal-close">Annuler</button>
                    <button type="submit" class="btn btn--primary">Confirmer l'inscription</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal-overlay hidden" id="eventModal">
        <div class="modal modal--large">
            <div class="modal-header">
                <h3 id="eventModalTitle">➕ Créer un événement</h3>
                <button class="modal-close">×</button>
            </div>
            <form id="eventForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="eventTitle">Titre *</label>
                        <input type="text" id="eventTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="eventType">Type *</label>
                        <select id="eventType" required></select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="eventDate">Date *</label>
                        <input type="date" id="eventDate" required>
                    </div>
                    <div class="form-group">
                        <label for="eventTime">Heure *</label>
                        <input type="time" id="eventTime" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="eventLocation">Lieu *</label>
                        <input type="text" id="eventLocation" required>
                    </div>
                    <div class="form-group">
                        <label for="eventMax">Places max *</label>
                        <input type="number" id="eventMax" min="1" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="eventDesc">Description *</label>
                    <textarea id="eventDesc" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="eventEmoji">Emoji (optionnel)</label>
                    <input type="text" id="eventEmoji" placeholder="🎉" maxlength="2">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn--outline modal-close">Annuler</button>
                    <button type="submit" class="btn btn--primary">💾 Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <div class="toast hidden" id="successToast">
        <div class="toast-content">
            <span class="toast-icon">✓</span>
            <span class="toast-message" id="toastMessage">Opération réussie !</span>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p class="footer-text">Développé avec ❤️ par <strong>Zinck Maxime</strong></p>
        </div>
    </footer>

    <script src="app.js"></script>
</body>
</html>
